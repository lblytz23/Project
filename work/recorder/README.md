# 屏幕录制软件

一个简单易用的屏幕录制工具，专为PPT演示录制优化，支持音视频同步录制，自动节省存储空间。

## ✨ 功能特点

- 🖥️ **全屏录制**：自动检测并录制整个屏幕
- 🎤 **音视频同步**：同时录制屏幕画面和系统/麦克风音频
- 💾 **空间优化**：针对PPT演示场景优化，自动跳过相似帧，大幅节省存储空间
- 📦 **MP4格式**：输出标准MP4格式，兼容性好
- 🎨 **简洁界面**：直观的图形界面，操作简单
- ⚡ **实时显示**：显示录制状态、时长等信息

## 📋 系统要求

- Windows 10/11
- Python 3.8+
- ffmpeg（用于视频合成）

## 🚀 安装步骤

### 1. 安装Python依赖

```bash
pip install -r requirements.txt
```

**注意**：PyAudio 在 Windows 上可能需要特殊安装：

#### 方法一：使用 pip（推荐尝试）
```bash
pip install PyAudio
```

#### 方法二：从 wheel 文件安装（如果方法一失败）
1. 访问 https://www.lfd.uci.edu/~gohlke/pythonlibs/#pyaudio
2. 下载对应Python版本的 `.whl` 文件
   - 例如：`PyAudio-0.2.14-cp311-cp311-win_amd64.whl` (Python 3.11, 64位)
3. 安装下载的文件：
   ```bash
   pip install PyAudio-0.2.14-cp311-cp311-win_amd64.whl
   ```

### 2. 安装 ffmpeg

#### 方法一：使用 Chocolatey（推荐）
```bash
choco install ffmpeg
```

#### 方法二：手动安装
1. 访问 https://ffmpeg.org/download.html
2. 下载 Windows 版本
3. 解压到任意目录（如 `C:\ffmpeg`）
4. 添加到系统 PATH：
   - 右键"此电脑" → "属性" → "高级系统设置" → "环境变量"
   - 在"系统变量"中找到"Path"，点击"编辑"
   - 添加 ffmpeg 的 bin 目录路径（如 `C:\ffmpeg\bin`）
   - 确定保存

### 3. 验证安装

```bash
# 验证 ffmpeg
ffmpeg -version

# 验证 Python 包
python -c "import cv2, pyaudio, pyautogui; print('All packages installed successfully!')"
```

## 📖 使用方法

### 启动程序

```bash
python screen_recorder.py
```

### 操作步骤

1. **启动程序**：双击运行 `screen_recorder.py` 或在命令行运行
2. **开始录制**：点击"开始录制"按钮
3. **选择保存位置**：在弹出的对话框中选择保存位置和文件名
4. **录制中**：程序会显示录制时长，最小化窗口不影响录制
5. **停止录制**：点击"停止录制"按钮
6. **等待处理**：程序会自动合成音视频，生成 MP4 文件

### 界面说明

- **状态**：显示当前录制状态（未录制/正在录制/正在处理）
- **时长**：显示录制时长
- **分辨率**：显示当前屏幕分辨率
- **保存位置**：显示输出文件名

## ⚙️ 技术参数

### 视频参数
- **帧率**：10 FPS（适合PPT演示，节省空间）
- **编码器**：H.264 (libx264)
- **质量**：CRF 28（平衡质量和文件大小）
- **优化**：自动检测帧变化，跳过相似帧

### 音频参数
- **采样率**：44.1 kHz
- **声道**：立体声（2声道）
- **编码器**：AAC
- **比特率**：128 kbps

### 空间优化策略

1. **低帧率**：10 FPS 适合 PPT 演示（相比 30 FPS 节省 67% 空间）
2. **帧差检测**：自动跳过变化小于 2% 的帧
3. **CRF 编码**：使用较高的 CRF 值（28），在保证清晰度的同时减小文件
4. **H.264 编码**：高压缩比，适合文字和图表内容

预计：1小时的PPT演示录制约 200-400 MB（取决于内容变化频率）

## 🛠️ 故障排除

### 问题1：提示"未找到 ffmpeg"
**解决**：确保 ffmpeg 已安装并添加到系统 PATH

### 问题2：PyAudio 安装失败
**解决**：使用 wheel 文件安装（见安装步骤）

### 问题3：录制没有声音
**解决**：
- 检查系统音量设置
- 确保麦克风权限已开启
- 检查默认音频输入设备

### 问题4：视频卡顿
**解决**：
- 关闭不必要的后台程序
- 降低录制分辨率（修改代码中的屏幕捕获区域）
- 确保有足够的磁盘空间

### 问题5：文件过大
**解决**：程序已针对PPT优化，如果仍觉得过大，可以：
- 修改 `fps` 参数（降低帧率）
- 修改 `crf` 参数（增大值可减小文件）

## 📁 项目结构

```
recorder/
├── screen_recorder.py      # 主程序
├── requirements.txt         # Python依赖
└── README.md               # 说明文档
```

## 🎯 使用场景

- ✅ PPT演示录制
- ✅ 在线会议录制
- ✅ 教学视频制作
- ✅ 软件操作演示
- ✅ 游戏录制（需调整帧率参数）

## 📝 自定义配置

如需修改录制参数，请编辑 `screen_recorder.py` 中的以下参数：

```python
self.fps = 10  # 帧率（建议10-30）
# 在 _merge_audio_video 方法中：
'-crf', '28',  # 质量参数（18-28，值越大文件越小）
'-preset', 'medium',  # 编码速度（ultrafast, fast, medium, slow）
```

## ⚠️ 注意事项

1. 录制时避免频繁切换窗口，可能影响录制效果
2. 确保有足够的磁盘空间（建议至少 1GB 可用空间）
3. 长时间录制建议关闭不必要的后台程序
4. 首次使用建议先录制几秒测试效果

## 📄 许可证

本项目仅供学习和个人使用。

## 🤝 贡献

欢迎提出问题和改进建议！

## 📧 联系方式

如有问题，请创建 Issue。

---

**祝您录制愉快！** 🎬

